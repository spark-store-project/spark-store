#/bin/bash

if [ "$(id -u)" != "0" ]
then
    echo "ss-apt-fast需要在root下运行"
    exit
fi

DEPEND=`which  apt-fast`
if [ "$DEPEND" = "" ] ; then 
echo "未安装依赖：apt-fast 开始安装"
apt install apt-fast -y
fi

rm /opt/durapps/spark-store/bin/apt-fast-conf/apt-fast.conf
echo "从服务器获取配置和镜像列表..."
curl -s --progress-bar -o /opt/durapps/spark-store/bin/apt-fast-conf/apt-fast.conf "https://gitee.com/deepin-community-store/repo_auto_update_script/raw/master/mirror-list-for-apt-fast/apt-fast.conf"

bwrap --dev-bind / / --bind '/opt/durapps/spark-store/bin/apt-fast-conf/apt-fast.conf' /etc/apt-fast.conf apt-fast "$@"